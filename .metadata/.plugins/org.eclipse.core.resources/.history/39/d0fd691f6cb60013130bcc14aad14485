package com.bluecoffee.controller;

import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.ui.Model;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.ModelAndView;

import com.bluecoffee.domain.FPost;
import com.bluecoffee.domain.FComment;
import com.bluecoffee.domain.FTag;
import com.bluecoffee.domain.MatSubject;
import com.bluecoffee.domain.User;
import com.bluecoffee.services.FPostService;
import com.bluecoffee.services.FCommentService;
import com.bluecoffee.services.FTagService;
import com.bluecoffee.services.UserService;

import java.io.*;
import java.util.*;

import javax.servlet.*;
import javax.servlet.http.*;

import org.apache.commons.fileupload.*;
import org.apache.commons.fileupload.disk.*;
import org.apache.commons.fileupload.servlet.*;
import org.apache.commons.io.output.*;

import javax.servlet.jsp.PageContext;

@Controller
public class ForumController {
	
	@Autowired 
	FPostService fPostService;
	@Autowired 
	FCommentService fCommentService;
	/*@Autowired 
	FTagService fTagService;
	@Autowired 
	UserService userService;
	*/
	
	@Autowired private User user;
	
	@RequestMapping("/forum")
	public String showPosts(Model model){
		
		List<FPost> fPostList = fPostService.getFPostList();
		model.addAttribute("fPostList", fPostList);
		
		return "forum";
	}

	@RequestMapping("/submitpost")
	public String submitPost(Model model){
		FPost fPost = new FPost();
		model.addAttribute("fPost", fPost);
		return "submitpost";
	}
	
	@RequestMapping("/insertpost")	//redirected from submitpost.jsp
	public String inserPost(@ModelAttribute FPost fPost) {
		if (fPost != null){
			
			fPost.setPostDate(new Date());
			//fPost.setUserID();  should be based on uploader(session attribute)
			fPost.setUserID(1);//for now, default
			fPost.setCommentCount(0);
			fPostService.insertData(fPost);
		}
		return "redirect:/viewpost";
	}
	
	@RequestMapping(value = "/viewpost", params = "pid")
	public String viewpost(Model model){
		
		
		
		
		
		
		//specific post
		
		return "viewpost";
	}
	
	@RequestMapping("/comment")
	public String comment(){
		
		return "comment";
	}
	
	
	
	
	
	
	
	/*
	@RequestMapping("/register")
	public String registerUser(@ModelAttribute FPost fPost) {

		return "register";
	}

	@RequestMapping("/insert")
	public String inserData(@ModelAttribute FPost fPost) {
		if (fPost != null)
			fPostService.insertData(fPost);
		return "redirect:/getList";
	}

	@RequestMapping("/getList")
	public ModelAndView getUserLIst() {
		List<FPost> fPostList = fPostService.getFPostList();
		return new ModelAndView("fPostList", "fPostList", fPostList);
	}

	@RequestMapping("/update")
	public String updateUser(@ModelAttribute FPost fPost) {
		fPostService.updateData(fPost);
		return "redirect:/getList";

	}
	*/
}
